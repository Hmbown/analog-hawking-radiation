Particle-in-cell simulation method for degenerate plasmas

D. Wu,1, (cid:3) W. Yu,2 S. Fritzsche,3, 4 and X. T. He1, 5
1Institute for Fusion Theory and Simulation, Department of Physics, Zhejiang University, 310058 Hangzhou, China
2Shanghai Institute of Optics and Fine Mechanics, 201800 Shanghai, China
3Helmholtz Institut Jena, D-07743 Jena, Germany
4Theoretisch-Physikalisches Institut, Friedrich-Schiller-University Jena, D-07743 Jena, Germany
5Key Laboratory of HEDP of the Ministry of Education, CAPT,
and State Key Laboratory of Nuclear Physics and Technology, Peking University, 100871 Beijing, China
(Dated: December 4, 2019)

Nowadays radiation hydrodynamic equations coupled with external equation of state provided by
quantum mechanical calculations is an intensively investigated approach for simulations of degen-
erate plasmas. Although such an approach is proven to be efficient and shows many good features,
specially for large scale simulations, it encounters intrinsic challenges when involving kinetic ef-
fects. As a complement, we here have invented a fully kinetic numerical approach for simulations
of plasmas with an arbitrary degeneracy level. This approach is based on first principle Boltzmann
equation coupled with Maxwell’s equations and a complicated collision operator, and is eventually
achieved via an existing particle-in-cell simulation code named LAPINS. In this approach, degen-
erate particles are initialized according to a Fermi-Dirac distribution function, and non-degenerate
particles are initialized following typical Maxwell distribution function. The equation of motion of
both degenerate and non-degenerate particles are governed by long range collective electromagnetic
fields and close particle-particle scatterings with degeneracy corrections. Especially, the evolutions
of degenerate particles are also constrained by the Pauli exclusion principle. The code is applied to
several benchmark simulations, including electronic conductivity for aluminium with temperature
from 0 (cid:0) 50 eV, equilibration of cold fuel shell and alpha particles in inertial confinement fusion,
and rapid heating of solid aluminium by intense laser beams.

PACS numbers: 52.38.Kd, 41.75.Jv, 52.35.Mw, 52.59.-f

I.

INTRODUCTION

Modelling degenerate plasmas is among the key inves-
tigation efforts for high energy density physics studies,
which is of significant importances to inertial confine-
ment fusion (ICF), astrophysical, and laboratory astro-
physical studies, for example, compression of the cold fuel
and capsule shell [1, 2], white dwarf starts [3], and high
power laser solid interaction experiments [4–7].

For degenerate plasmas, density functional theory-
molecular dynamics (DFT-MD) method [8–13] is inten-
sively investigated. This method is though to be accurate
however is limited in the problems it can be applied to
due to its significant computational expense. Radiation
hydrodynamic simulation [14, 15] coupled with external
equation of state data provided by DFT-MD calculations
is a nowadays widely applied approach. Although such
an approach is proven to be efficient and shows many
good features, specially for large scale simulations, it en-
counters intrinsic challenges when involving kinetic ef-
fects, for example, degenerate thermal equilibration and
the stopping of high energy alpha particles by degenerate
electrons in ICF.

The particle-in-cell (PIC) method [16] has established
itself as a state of the art method for solving problems
It is a compromise between
in kinetic plasma physics.

(cid:3) Email: dwu.phys@zju.edu.cn

fundamental quantum mechanical simulations, i.e. DFT-
MD, and macro-field only methods, i.e., radiation hydro-
dynamic simulations. The main advantages of the PIC
method are that their memory consumption increases
linearly with the simulated volume and that the run-
time is only of order N . They are also very suitable
for the use of large multi-processor systems. Although
the present PIC method is very successful in a great va-
riety of research branches, when referring to degenerate
plasmas, tremendous challenges still remain. For degen-
erate plasmas, usually, the electron density is more than
solid density. However the main disadvantages of PIC
method are high noise levels and high computational re-
quirements for plasmas at solid densities. Within simu-
lations, plasma frequency needs to be resolved, and the
grid size must be comparable to the Debye length in order
to minimize artificial grid heating and suppress numer-
ical instabilities. In addition to tremendous simulation
burdens, degenerate particles can no longer be regarded
as classically distinguishable, and they obey Fermi-Dirac
statistics. However, whether the PIC method based on
classically distinguishable macro-particles is able to ma-
nipulate Fermi-Dirac rules is still open.

On the positive side, higher order interpolation algo-
rithms have long been utilized in explicit PIC method,
which is, to some extent, successful in suppressing arti-
ficial grid heating and suppress numerical instabilities.
However for degenerate plasmas, usually the electron
density can be as high as 1024 cm(cid:0)3, challenges still re-
main for high order explicit PIC methods. Recently, we

proposed a high order interpolation implicit PIC method
for plasma simulations at solid densities [17], and imple-
mented in the LAPINS code. This is achieved by com-
bining a high-order scheme of special difference with an
implicit scheme of temporal stepping. This new scheme
can completely remove the numerical self-heating and sig-
nificantly reduce the simulation burden when simulating
solid density plasmas. In the meanwhile, another numer-
ical method that combines the PIC method with a re-
duced model of high density plasma based on Ohm’s law
was also proposed [18], implemented and benchmarked
in the LAPINS code. Here, the electric field is solved via
E = (cid:17)Jbg (cid:0) ubg (cid:2) B, with (cid:17), Jbg, and ubg the conductiv-
ity, current density and average velocity of background
plasmas, respectively. This method is proven to be effi-
cient and a good choice for transport studies of energetic
particles in solid density plasmas, provided the high fre-
quency electromagnetic fields are not of significance.

For solid density plasmas, when the temperature is
lower than the Fermi temperature, degeneracy effect ap-
pears. Actually this effect has long been noticed in PIC
simulations for solid density plasmas. For example, to
avoid a divergence of the Spitzer collision frequency in
cold plasma, Sentoku [19] set a threshold of plasma tem-
perature Ttr for a degenerate plasma. Collision frequency
with energy less than Ttr is cut off with a constant value.
Here in this paper, we have invented a self-consistent
kinetic approach for simulation of plasmas with an arbi-
trary degeneracy level. This approach is based on first
principle Boltzmann equation coupled with Maxwell’s
equations and a complicated collision operator, and is
eventually achieved via an existing particle-in-cell simu-
lation code named LAPINS. With this approach, degen-
erate particles are initialized according to a Fermi-Dirac
distribution function, and non-degenerate particles are
initialized following typical Maxwell distribution func-
tion. The equation of motion of both degenerate and
non-degenerate particles are governed by long range col-
lective electromagnetic fields and close particle-particle
scatterings with degeneracy corrections. Especially, evo-
lutions of degenerate particles are also constrained by
the Pauli exclusion principle. In the end, LAPINS code
is applied to several benchmark simulations, which in-
cludes electronic conductivity for aluminium with vary-
ing temperatures, equilibration alpha particles with cold
fuel shell in ICF, and rapid heating of solid aluminium
by intense laser beams.

The paper is organized as follows. In Sec. II, the basic
theoretical framework, i.e., Boltzmann equation coupled
with Maxwell’s equations and a complicated collision op-
erator is outlined. Section III is the core part of this
paper. Fermi-Dirac distribution initialization of degen-
erate particles along with the implementation of Pauli
exclusion principle is presented. Moreover, the degener-
acy corrected collision model and ionization model are
also briefly discussed. In section IV, we present several
simulation experiments to benchmark this new approach.
Finally, summary and discussion are given in Sec. V.

2

II. BOLTZMANN EQUATIONS

In Boltzmann theory, a plasmas consisting of elec-
trons and ions is represented by distribution functions
fk of seven variables, i.e., the position r, velocity u, and
time t. The distribution function fk gives the probability
fk(r; u; t)drdu of finding particles of k species in a given
volume of six-dimensional phase space drdu. The elec-
trons and ions in plasma under consideration interact via
long range electromagnetic fields and close binary colli-
sions. Hence, an appropriate description of the plasma is
based on the following Boltzmann equation,

@fk
@t

+ uk (cid:1) @fk
@r

(cid:0) qk
mk

(E + uk (cid:2) B) (cid:1) @fk
@uk

=

@fk
@t

jcoll; (1)

where E and B are the electric and magnetic fields, and
qk is the value of particle charge, and mk is the particle
mass. The Maxwell’s Equations read,

∇ (cid:2) E = (cid:0)@tB;
∇ (cid:2) B = @tE + 2(cid:25)J;
∇ (cid:1) E = 2(cid:25)(cid:26):

(2)
(3)
(4)

Boltzmann equation, Eq. (1), is coupled with Maxwell’s
equations via charge density (cid:26) and current density J,
defined as

∫

(cid:26)(r) =

J(r) =

∑

k
∑

k

qk

qk

∫

d3ukfk;

d3ukukfk:

(5)

(6)

In Eq. (1), @fk=@tjcoll is the rate of change of the distribu-
tion function due to scatterings, which includes contribu-
tions from both the same species, e.g. electron-electron
and ion-ion scatterings, and the different species, e.g.
electron-ion and electron-neutral scatterings.

In principle, the distribution function fk can be of
any form, provided the normalization condition is sat-
isfied. For ideal plasmas, under local equilibrium, fk
obeys Maxwell distribution fk (cid:24) exp((cid:0)Ek=Tk), with Ek
of energy and Tk of temperatures. As an alternative so-
lution of coupled Eqs. (1)-(6), plasma physicists have de-
veloped the PIC method based on the theory of charge
assignment and force interpolation. This important the-
ory has made it possible to obtain smooth distributions of
charge density and current density in Maxwell’s equation
of electromagnetic fields. The PIC method, including the
Monte Carlo (MC) treatment of collisions, is called the
PIC/MC method. Takizuka and Abe [20] used to pro-
posed a Monte Carlo approach for collisions, based on the
binary collision approximation. In this approach, parti-
cles are randomly paired with each other in close prox-
imity and scattered with Coulomb collisions, each one
of which conserves energy and momentum. Apart from
conservation, the greatest strength of this approach is the
ability to work with any distribution function, especially

3

A. Fermi-Dirac Statistics of Electrons

For degenerate plasmas, due to the anti-commutation
relation for identical fermions, the distribution function
for electrons obey Fermi-Dirac distribution,

fe(E) =

(2me)3=2
2ne(cid:22)h3(cid:25)2

p

E
exp(E=Te (cid:0) (cid:17)) + 1

;

(7)

where (cid:17) is the degeneracy parameter, and fe(E)dE is the
probability for finding electrons with energy between E
and E + dE. Degeneracy parameter (cid:17) can be obtained
by equation normalization,

∫

(2me)3=2
2ne(cid:22)h3(cid:25)2

p

EdE
exp(E=Te (cid:0) (cid:17)) + 1

= 1:

(8)

Here, Eq. (8) defines (cid:17) as a function of ne and Te. The
occupancy function is the measure of the proportion of
states occupied at energy E, and is given by,

fo(E) = fe(E)=ge = (E)

1
exp(E=Te (cid:0) (cid:17)) + 1

;

(9)

p

E=2ne(cid:22)h3(cid:25)2 is the density of
where ge(E) = (2me)3=2
states between E and E + dE. From Eq. (8), (cid:17) = (cid:0)1
corresponds to the classical limit in which the distri-
bution functions become Maxwell distributions. In the
zero temperature limit, (cid:17) = EF =Te and (cid:17) = 1, with
EF = (3(cid:25)2ne)2=3(cid:22)h2=2me of the Fermi energy. Note,
(cid:17) = 1 is the fully degenerate limit, in which all par-
ticles are at energies below or equal to the Fermi energy,
and the occupancy function becomes a step function:
g(E) = 1 with E (cid:20) EF ; and g(E) = 0 with E > EF . For
non-Maxwellian distributions, temperature and average
energy no longer satisfy Te = (2=3)Eave, where Eave is
In the case of the Fermi-
the average kinetic energies.
Dirac distribution, particles retain an energy even in the
Te = 0 limit. This is because, lower energy states have
limited capacity and become fully occupied, so that re-
maining particles occupy energy states higher than the
ground state.

Particles with a defined distribution function can be
initialised in the PIC code.
Ions or atoms obeying
Maxwellian distributions are initialised using the Box-
Muller transform method [23], which is proven to be com-
putationally efficient. For distributions which are every-
where integrable, the probability density function, i.e.,
the distribution function, can be integrated to the cu-
∫
x
0 f (x′)dx′ = F (x). The cu-
mulative density function
mulative density function is normalised, with F (0) = 0
and limx!1 F (x) = 1. Inversion of the cumulative den-
sity function with F (cid:0)1(u) = x; u 2 (0; 1) represents a
parametrisation of the real number line between 0 and
1 into the space of the variable. Randomly generated
values of u, uniformly distributed and in the domain of
F (cid:0)1(u), generate values of x that occur with frequencies
determined by the original probability density function.

FIG. 1.
(color online) Schematic representation for energy
levels of degenerate plasma in the LAPINS PIC code. The
electrons are classified, into bound and free ones, where the
former are regarded as part of ions or atoms, and the latter
are isolated as the surrounding plasmas. Free electrons and
bound electrons can interchange with each other trough ion-
ization and recombination processes. The energy distribution
of free electrons is described by Fermi-Dirac statistics. Ions or
atoms along with the bound electrons are treated as classical
particles and obey Maxwell statistics.

those which depart appreciably from a Maxwell distri-
bution. It has been extended several times for example
by Sentoku [19], Wu [21] and Turrell [22] with arbitrary
particle weight, inelastic scatterings and degeneracy cor-
rections.

III. NUMERICAL IMPLEMENTATION

Boltzmann equation indicates that fk in Eq. (1) can
be of any form, provided normalization condition is sat-
isfied. In order to simulate degenerate plasmas, here we
have invented a fully kinetic numerical approach that can
be configured and embedded into existing PIC simula-
tion codes. In this approach, as schematically displayed
in Fig. 1, we use a collection of macro-particles to de-
scribe a plasma or matter of finite ion density. Here,
a macro-particle can be regarded as the ensemble of real
particles, i.e., a group of particles with same mass, charge
state, position, and momentum. The electrons are clas-
sified, moreover, into bound and free ones, where the
former are regarded as part of ions or atoms, and the
latter are isolated as the surrounding plasmas. Espe-
cially, free electrons and bound electrons can interchange
with each other trough ionization and recombination pro-
cesses. While ions or atoms along with the bound elec-
trons are treated as classical particles and obey Maxwell
statistics, free electrons in our method are dominated by
Fermi-Dirac statistics.

EnergyFree electronBound electronFermi-Dirac Dist.As the Fermi-Dirac distribution is not integrable, this
process cannot be done analytically, and numerical meth-
ods of calculating the inverse cumulative distribution
function must be used.
In the LAPINS code, we em-
ploy Hormann and Leydold’s algorithm [24] to numeri-
cally compute the energy values in order to initialise de-
generate particles. In this method, the domain of F (cid:0)1(u)
is split into equally spaced sub-intervals and a cubic Her-
mite polynomial Hi(u) is used to interpolate values of E
for given u, with F (E)i (cid:20) u (cid:20) F (E)i+1.

4

For given value of particle energy E, components of
each particle’s velocity are calculated as follows. For an
isotropic distribution of velocities, each energy can be
thought of as defining a radius of a sphere in velocity
space. When scaling a value with ue =
2E=me, the ve-
p
1 (cid:0) r2 cos(ϕ),
locity components are given by: ux = ue
1 (cid:0) r2 sin(ϕ), and uz = uer, where r 2 ((cid:0)1; 1)
uy = ue
and ϕ 2 (0; 2(cid:25)).

√

p

Before computing the energy values in order to ini-
tialise degenerate particles, degeneracy parameter (cid:17) in
Eq. (7) need to be solved out in advance. Given ini-
tial temperature Te and electron density ne in Eq. (8),
the calculation of (cid:17) can be done only by using numerical
method. Here in LAPINS code, a golden section search
method [25] is used for the minimisation of the root sum
square, and calculation of (cid:17).

When initialised, as shown in Fig. 2, we have plot-
ted the energy distribution of free electrons for solid alu-
minium at Te = 1 eV, Te = 5 eV and Te = 10 eV, respec-
tively. Distributions produced by Fermi-Dirac statistics
are displayed by triangles, and by Maxwell statistics are
displayed by diamonds. For solid aluminium, the aver-
age ionization degree is (cid:22)Z = 3 at room temperature, and
the free electron density can be as high as 1:8 (cid:2) 1023
cm(cid:0)3. Following Eq. (8), the Fermi energy is EF = 11:2
eV. As shown in Fig. 2, when temperature is well be-
low Fermi energy, Fermi-Dirac distributions significantly
depart from Maxwell distributions, and states with ener-
gies lower than Fermi energy, are fully occupied. When
temperature is well above Fermi energy, Fermi-Dirac dis-
tribution become close to the Maxwell distributions. Ac-
tually, at high temperatures with Te ≫ EF , Fermi-Dirac
statistics will become identical to Maxwell statistics, and
the proportion of states occupied with any energy E is
zero, fo(E) ! 0 8E.

However, particles in PIC simulations are treated as
distinguishable classical macro-particles, and initialised
Fermi-Dirac distributions would relax to Maxwell distri-
butions due to particle-particle and particle-field interac-
tions. To prevent this, one must take into account Pauli
exclusion principle. Here, we assume all processes which
lead to changes in energies of degenerate particles, such as
particle-particle scatterings or acceleration/deceleration
by electromagnetic fields, must be constrained by Pauli
exclusion principle. This principle prevents degenerate
particles being scattering into an energy state E if that
state is already occupied. The occupancy function, Eq.
(9), is the measure of the proportion of states occupied

FIG. 2. (color online) The LAPINS PIC code producing a
Fermi-Dirac distribution of free electrons for solid density alu-
minium at Te = 1 eV, Te = 5 eV and Te = 10 eV, respectively.
(a) It is shown against Maxwell and Fermi-Dirac distributions
with the same parameters. (b) The occupation function sam-
pled from the simulation distribution function.

FIG. 3. (color online) Schematic presentation of the two-fold
interpretation method. Here, n is the size of array containing
distribution functions. See text for further explanations.

at energy E. As fo takes values between 0 and 1, from
the point of view of PIC/MC simulations, it indicates
whether a particular energy changing process should be
blocked or not. The probability of accepting a change to
final energy should be 1 (cid:0) fo(E), therefore fully occupied
states admit no more particles. The probability of ac-
cepting a new energy change depend on the degeneracy,
therefore for the classical limit with (cid:17) ! 1, fo(E) ! 0
is reproduced for any E.

As reflected in Eq. (9), fo depends on the local distri-
bution function. Within PIC/MC simulations, the local
distribution function can be generated by collecting all
particles within a computational cell.
In order to gen-
erate a smooth fo as a function of particle energy, the
number of particles in each cell should be on order of
magnitudes 103 or even larger. For a typical PIC sim-
ulation with computational grids at 103, it will quickly
become computationally intractable. To avoid such an

Fermi-DiracMaxwellTe=1.0 eVTe=5.0 eVTe=10. eV(a)(b)5

clusion principle on changes in particle energy with the
final energy Ef, a random number R is generated. With
R 2 (0; 1) and Ef: block the change if R < fo(Ef); accept
the change if R > fo(Ef). For two-body processes, such
as fermion-fermion scatterings, there is a natural exten-
sion. With finial energies Ef1 and Ef2: block the change,
if R < fo(Ef1) + fo(Ef2) (cid:0) fo(Ef1) (cid:1) fo(Ef2). Here, we
always set fo(Ef) = 0 for non-degenerate particles and
degenerate particles with final energy larger than the cut-
off energy Ec. For ideal plasmas, fo(E) = 0 8E, changes
in particle energy is no longer blocked.

In order to benchmark the implemented Pauli block
method, a simulation box is divided into 10 (cid:2) 10 (cid:2) 10
computational cells bounded by periodic conditions, with
each cell contains 100 macro-electrons. Here, energy dis-
tribution of free electrons for solid aluminium with Te = 1
eV is displayed in Fig. 4. As shown in Fig. 4 (a), an ini-
tial Fermi-Dirac distribution relaxes to Maxwell distri-
butions after only 1 femtosecond. However when taking
into account Pauli exclusion principle, as shown in Fig.
4 (b), Fermi-Dirac distribution sustains within the en-
tire simulation duration. Note, the simulation speed is
only slightly affected by including Pauli exclusion prin-
ciple. This is because, the same interpretation method
is used throughout the code for both current assignment
and force interpretations.

B. Collisions

In the LAPINS code, treatment of collisions is based
on Monte Carlo binary collision approximation. This
method was originally proposed by Takizuka and Abe
[20], and then extended several times, for example, by
Sentoku [19].
In this approach, particles are randomly
paired with each other in close proximity and scat-
tered with collisions, each one of which conserves energy
and momentum. Apart from conservation, the greatest
strength of this approach is the ability to work with any
distribution function, especially those which depart ap-
preciably from a Maxwell distribution.

In practical implementation, the Monte Carlo binary
collision model requires knowledge of the momentum
transfer cross sections.
In the partial wave calculation
[26], this momentum transfer cross section can be ob-
tained by numerical solution of the Schroedinger equa-
tion for a well defined potential.
In the original work
of Lee and More [27], the Thomas-Fermi potential was
taken as an approximate candidate. Recently, more
rigorous approach has been proposed by Starrett [26]
that includes correlations with electrons and ions sur-
rounding the central scatterer through the quantum fluid
equations. Comparing with these numerically calcu-
lated cross sections, here in the LAPINS code, screened
Coulomb cross section with approximate cut-off param-
eters is used. This is because, our goal is to invent an
simulation method for degenerate plasmas for practical
applications, and we need a simple yet approximately ac-

(color online) (a) With initial Fermi-Dirac distri-
FIG. 4.
bution,
it has relaxed to Maxwell distributions after 1 fs.
(b) Also with initial Fermi-Dirac distribution, when including
Pauli exclusion principle, it sustains within the entire simu-
lation duration. Simulation parameters are the same with as
displayed in Fig. 2 with Te = 1 eV.

incredible simulation burden and simultaneously gener-
ate a smooth distribution or occupation function, we here
propose a two-fold interpretation method.

The schematic presentation of this two-fold interpre-
tation method is displayed in Fig. 3. Attaching each
computational cell, we define an array with size, for ex-
ample, n = 50. This array is used to contain the local
distribution function of degenerate particles. The cut-off
energy here is defined as, for example, Ec = 2EF , where
EF = (3(cid:25)2ne)2=3(cid:22)h2=2me is the Fermi energy. Note, this
cut-off energy Ec is a global constant. Once initially de-
fined, it is shared by each array during the entire simu-
lation duration. The array index is therefore defined as
Ek = kdE, with k 2 [0; n], dE = Ec=n, and n = 50.
Within PIC simulations, for a degenerate particle with
an arbitrary weight w, only if the particle’s energy is
located within 0 < E < Ec, the particle is used to
fill an array. Locate the nearest two elements, k and
k + 1, with Ek < E < Ek+1, and then fill them with
Fk = w(1 (cid:0) (cid:14))S(r (cid:0) R) and Fk+1 = w(cid:14)S(r (cid:0) R). Here,
(cid:14) = (E (cid:0) kdE)=dE and S(r (cid:0) R) is the particle shape
i;j;k S[r (cid:0) (ix + jy + kz)] = 1
function, with which
is satisfied. Note the particle shape function used here
shares the same idea with the high order interpolation al-
gorithms for current assignment and force interpolation
widely used in PIC codes in order to suppress numerical
noises. This two-fold interpretation method could signif-
icantly avoid incredible simulation burden by using less
particles per cell and simultaneously generate a smooth
distribution or occupation function.

∑

In PIC simulations, in order to include the Pauli ex-

(a)(b)t=0 fst=1 fst=3 fst=0 fst=1 fst=3 fscurate method for calculating cross sections.

To calculate Coulomb cross section, one of the practical
approaches, as used by Takizuka [20] and Sentoku [19],
is to sum binary collisions over a distance of the order of
the Debye length. Under the Coulomb potential of 1=r,
the differential cross-section reads,

(cid:27)((cid:18)) (cid:24) 1= sin4((cid:18)=2);

(10)

and the Coulomb logarithm reads,

L (cid:24)

∫

(cid:25)

0

sin (cid:18) sin2((cid:18)=2)(cid:27)((cid:18))d(cid:18) (cid:24) ln[sin((cid:18)=2)]j(cid:25)
0

(11)

This integration is not a convergent value, when (cid:18) ! 0.
While in plasmas, the potential of a charged particle
should be screened. When b, i.e., the minimum impact
parameter, is larger than (cid:21)D, the potential is artificially
set to be zero. Therefore, the lower limit (cid:18)min of scatter-
ing angle is obtained when b = (cid:21)D, i.e., (cid:18)min=2 = b=(cid:21)D.
Thus we have L (cid:24) ln((cid:21)D=b). In this model, for high en-
ergy density plasmas with b close to or even larger than
(cid:21)D, the Coulomb logarithm is artificially cut-off with a
value equal to 2:0.

However instead of the above method, a rigorous way is
to sum binary collisions with all surrounding particles us-
ing the screened potential exp((cid:0)r=(cid:21)D)=r. Acted by this
screened potential, under Born approximation, the dif-
ferential cross-section can be analytically obtained with

(cid:27)((cid:18)) (cid:24) 1=[sin2((cid:18)=2) + (cid:24)]2;

(12)

where (cid:24) is noting but the ratio of minimum impact pa-
rameter and the Debye length. (cid:24) = bmin=(cid:21)D. The mini-
mum impact parameter is set by the classical distance of
closest approach. This gives

bmin = ZaZbe2=mabu2

ab;

(13)

Here, Za and Zb are the charge number of particle a
and particle b, mab and uab are their reduced mass and
relative velocity. However, at high energy, bmin is set by
the uncertainty principle. We have

bmin = (cid:21)=2 = (cid:22)h=mabuab;

(14)

∫

here (cid:21) is the de-Broglie wavelength. The Coulomb loga-
rithm L (cid:24)
0 sin (cid:18) sin2((cid:18)=2)(cid:27)((cid:18))d(cid:18) by applying the new
differential cross-section is integrable with

(cid:25)

L (cid:24) ln[1 + 2(cid:17) (cid:0) cos((cid:18))]j(cid:25)
0

(cid:24) ln[(1 + (cid:17))=(cid:17)]:

(15)

This expression of Coulomb logarithm will converge to
L = ln ((cid:21)D=b) when b ≪ (cid:21)D for ideal plasmas. For high
energy density plasmas, this expression of Coulomb log-
arithm reduces to zero.

In our model, the screen is only determined by the De-
bye length. This length, following Debye-Huckel theory,
can be written as,

1
(cid:21)2
D

=

4(cid:25)nee2
kTe

+

4(cid:25)nie2 (cid:22)Z 2
kTi

;

(16)

6

where Te and Ti are the electron and ion temperature,
ne and ni are the electron and ion density, and (cid:22)Z is
the average ionization degree. Note, the ion contribu-
tion is dominant for plasmas containing heavy atoms.
The degeneracy correction to the screening is to multi-
ply the first term on the right hand of Eq. (16) by a factor
F ′
1=2=F1=2, i.e., the logarithm of derivative of the Fermi
integral,

Fj(x) =

∫ 1

0

xjdx
1 + exp(x (cid:0) (cid:17))

;

(17)

where (cid:17) is the degeneracy parameter defined by Eq. (8).
The second term remains unchanged. According to the
original work of Brysk, Campbell and Hammerling [28],
such a degeneracy correction can be approximated to

1
(cid:21)2
D

=

4(cid:25)nee2
e + E2

(T 2

F )1=2

+

4(cid:25)nie2 (cid:22)Z 2
Ti

:

(18)

This approximation matches the numerical calculation of
the factor F ′
1=2=F1=2 within 5%, giving negligible error in
the logarithm.

For electrons of Fermi-Dirac distributions, diagnosing
the electron temperature is non-trivial. Here, the average
electro energy is

(cid:22)E =

p

3

(cid:25)

8

Te
ne

(2meTe)3=2
(cid:22)h3(cid:25)2

F3=2((cid:17)):

(19)

∑

For ideal plasmas, i.e., (cid:17) ! (cid:0)1, (cid:22)E = (3=2)Te, and for
fully degenerate plasmas, i.e., (cid:17) ! 1, (cid:22)E = (3=5)EF .
Within PIC simulations, Eq. (19) can be approximated
∑
by (cid:22)E (cid:24) (cid:22)EPIC =
i wi, where ϵi is the energy
for each single macro-particle and wi is the corresponding
weight. The first term on the right hand of Eq. (16) can
therefore be directly approximated as 4(cid:25)nee2= (cid:22)EPIC, also
giving negligible error in the logarithm.

i wiϵi=

For projectile moving in the plasmas, the static Debye
length needs to be replaced by a corresponding dynami-
cal value. According to Zwicknagel [29], this dynamical
Debye length reads ~(cid:21)D = (cid:21)D(1 + mabu2
In the
LAPINS code, this dynamical correction is used as de-
fault, although we have about a factor 2 difference in the
logarithmic scale. This is because, having one general
formula for stopping and relaxation problems is useful
for practical applications, such as the laser-solid inter-
actions, which contains the fast particle stopping and
thermalization simultaneously.

ab=T 2

e ).

In the simulations, the frequency of scattering between

particle a and particle b is

(cid:23)ab =

2(cid:25)e2ZaZbnminL
abu3
ab

m2

;

(20)

where L is the Coulomb logarithm, and nmin is the min-
imum density for particle species a and b. After calcu-
lating (cid:23)ab for a given pair of particles, the velocity or
energy change within a scattering is evaluated following

7

FIG. 5. (color online) The average ionization degree of solid
aluminium as a function of temperature. Black square line
is the one without degeneracy corrections, and blue diamond
line is the one with degeneracy corrections.

the typical routine proposed by Takizuka and Abe [20].
However, in the LAPINS code, the change of velocity or
energy needs to be constrained by the Pauli exclusion
principle: block or accept depending on the local occu-
pation function fo.

C.

Ionizations

In the LAPINS code, the treatment of ionization is di-
vided into two parts: field ionization [30, 31] and impact
ionization. As field ionization usually appears under low
density plasmas, therefore, there is no need to take into
account degeneracy corrections. For solid density plas-
mas, a dynamic ionization model was proposed by Wu
[32], taking into account impact ionization, electron-ion
recombination and ionization potential depression (IPD)
by the shielding of surrounding plasmas. Here, we would
suggest to include the degeneracy effect by correcting ion-
ization potential with P (cid:0) ∆P + EF , with P the isolated
ionization potential [33], ∆P the IPD correction [34, 35],
and EF the Fermi Energy. As there is no space to con-
tain the newly ionized electrons with energy lower than
EF , the minimum kinetic energy of a newly ionized elec-
tron must be higher than EF . Numerical experiments,
Fig. 5, have showed that such a degeneracy correction
would slightly decrease the ionization cross section and
therefore the average ionization degree with temperature
comparable to and lower than EF .

IV. BENCHMARKS

In this section, the code is applied to several bench-
mark simulations, including electronic conductivity for
aluminium, equilibration of cold fuel shell and alpha par-
ticles in inertial confinement fusion, and rapid heating of
solid aluminium by intense laser beams.

FIG. 6. (color online) The evolutions of electron current den-
sity of a solid aluminium sample as functions of time, when
externally applying a small electric field. Here, black, red
and blue curves are the ones with Te = 1 eV, Te = 10 eV and
Te = 20 eV, respectively.

A. Electronic conductivity of aluminium

The calculation of electronic conductivity in high en-
ergy density plasmas is a challenging problem. One ap-
proach is to use DFT-MD coupled with Kubo-Greenwood
formalism [8, 9]. This method is thought to be curate but
is limited in the problems it can be applied to due the
significant computational expense.

Another class of methods starts from the Boltzmann
equation and introduces a relaxation-time approximation
in which electrons are scattered from ions. The question
then becomes calculating the electron-ion cross sections.
To calculate the electron-ion cross section in high energy
density plasmas, one needs to define an electron-ion scat-
tering potential. How this definition is made strongly af-
fects the resulting conductivities. Recently, a new quan-
tum potential is defined by Starrett [26], who couple aver-
age atom models to the relaxation-time approximation.
This potential includes correlations with electrons and
ions surrounding the central scatterer through quantum
Ornstein-Zernike equations [36]. Results indicates that
this new potential leads to quite accurate conductivity
predictions when to compared to DFT-MD simulations.
As the underling frame of the LAPINS code is
Boltzmann equation coupled with Maxwell equations,
for electronic conductivity calculation, the
therefore,
relaxation-time approximation algorithm is naturally re-
covered by applying a small external electric field on a
plasma sample. Free electrons are accelerated by this
small electric field, and simultaneously experience colli-
sions with ions. When reaching steady state, the conduc-
tivity is evaluated as (cid:27) = J=E, with J and E of current
density and electric field.

In Fig. 6, we have plotted the evolution of electron
current density of a solid aluminium sample, when ex-
ternally exposing in a small electric field. This current
density increases at initial time due to the acceleration of
electric field and then reaches saturation due to the anti-

8

(color online) Electrical conductivity of solid alu-
FIG. 7.
minium. Degenerate PIC simulation method are compared
with full quantum mechanical calculations, including both
partial wave method from Starrett [26] and Kubo-Greenwood
DFT-MD method from Witte [37].

FIG. 9. (color online) Simulation of intense laser interaction
with a solid aluminium sample, displaying the energy den-
sity distribution for free electrons. The laser intensity is of
1016 W/cm2. (a) and (b) correspond to degenerate and non-
degenerate simulations.

B. Equilibration of cold fuel shell and alpha
particles

Here, we present an application of the LAPINS code
to the interaction between fusion produced alpha parti-
cles and background high density deuterium-tritium plas-
mas. In ICF, the yield of neutrons is particularly sensi-
tive to electron-ion equilibration. Simulations of direct-
drive implosions have shown a 10% difference across sev-
eral different models of temperature relaxation [38]. The
distribution of fusion produced alpha particles is highly
non-Maxwellian, however the LAPINS code with the im-
plemented collision method is capable of modelling such
an complex interaction. Fig. 8 shows a simulation with
parameters approximately similar to ICF: an isotropic
flux of mono-energetic fusion produced alpha particles
interacting with a cold fuel shell of deuterium, tritium
and electrons. For comparison, the numerical simulation
is also shown against the non-degenerate equilibration
case. The degenerate simulation predicts a significantly
slow relaxation rate, due to the reduction of collisions by
Pauli exclusion principle.

FIG. 8.
(color online) An equilibration scenario with pa-
rameters approximately similar to inertial confinement fu-
sion: starting temperatures of electrons, deuterium and tri-
tium are 12:5 eV, the density is nD = nT = 1:2 (cid:2) 1024 cm(cid:0)3;
n(cid:11) = 0:01nD and ne = 2:4 (cid:2) 1024 cm(cid:0)3, (cid:11) particles have an
initial energy of 3:54 MeV. Solid line is for degenerate simu-
lation, and dashed line is for non-degenerate simulation.

balance forces from collisional scatterings. Here, black,
red and blue curves represent evolutions at different tem-
peratures, with Te = 1 eV, Te = 10 eV and Te = 20
eV, respectively. In Fig. 7, electronic conductivity calcu-
lated by the LAPINS code are compared with full quan-
tum mechanical calculations, including both partial wave
method from Starrett [26] and Kubo-Greenwood DFT-
MD method from Witte [37]. It is shown that the LAP-
INS code could generally produce accurate conductivity
predictions when to compared to full quantum mechan-
ical simulations. The departure is due to the simplified
cross-section used in the PIC code.

C. Rapid heating of solid aluminium

Here, we present an application of the LAPINS code
to the interaction of intense laser beam with a solid alu-
minium. Fig. 9 shows a the energy density distribution
for free electrons. For comparison, the numerical simula-
tion is also shown against the non-degenerate equilibra-
tion case. The degenerate simulation predicts a signifi-
cantly larger hot spot, due to enhanced range of thermal
electrons influenced by Pauli exclusion principle.

White (HSE)White (PBE)Partial WaveDegenerate PIC(a)(b)V. DISCUSSIONS AND CONCLUSIONS

To summarize, in this paper, we have invented a self-
consistent kinetic approach for simulation of plasmas
with an arbitrary degeneracy level. With this approach,
degenerate particles are initialized according to a Fermi-
Dirac distribution function, and non-degenerate parti-
cles are initialized following typical Maxwell distribution
function. The equation of motion of both degenerate and
non-degenerate particles are governed by long range col-
lective electromagnetic fields and close particle-particle
scatterings with degeneracy corrections. Especially, evo-
lutions of degenerate particles are also constrained by the

9

Pauli exclusion principle. The new code might find great
applications in ICF, astrophysical, and laboratory astro-
physical studies. The method invented in this paper is
applicable for plasmas with any degeneracy, however it
needs to be carefully evaluated when applying to strong
coupling plasmas.

ACKNOWLEDGMENTS

This work was supported by Science Challenge Project
(No. TZ2016005), National Natural Science Foundation
of China (No. 11605269) and National Basic Research
Program of China (Grant No. 2013CBA01504).

[1] J. Lindl, Development of the indirect-drive approach to
inertial confinement fusion and the target physics basis
for ignition and gain, Physics of Plasmas 2, 3993 (1995).
[2] Y. Setsuhara, H. Azechi, N. Miyanaga, H. Furukawa, R.
Ishizaki, K. Nishihara, M. Katayama, A. Nishiguchi, K.
Mima, S. Nakai, Laser and Particle Beams 8, 609 (1990).
[3] J. P. Cox, R. T. Giuli, Principles of Stellar Structure
Volume II: Applications to Stars, Gordon and Breach
Science Publishers, 1968.

[4] F. N. Beg, A. R. Bell, A. E. Dangor, C. N. Danson, A.
P. Fews, M. E. Glinsky, B. A. Hammel, P. Lee, P. A.
Norreys. and M. Tatarakis, Phys. Plasmas 4, 447 (1997).
[5] P. K. Patel, A. J. Mackinnon, M. H. Key, T. E. Cowan,
M. E. Foord, M. Allen, D. F. Price, H. Ruhl, P. T.
Springer, and R. Stephens, Phys. Rev. Lett. 91, 125004
(2003).

[6] W. Bang, B. J. Albright, P. A. Bradley, E. L. Vold, J. C.
Boettger, and J. C. Fernandez, Phys. Rev. E 92, 063101
(2015).

[7] G. M. Dyer, A. C. Bernstein, B. I. Cho, J. Osterholz, W.
Grigsby, A. Dalton, R. Shepherd, Y. Ping, H. Chen, K.
Widmann, and T. Ditmire, Phys. Rev. Lett. 101, 015002
(2008).

[8] M. P. Desjarlais, J. D. Kress, L. A. Collins, Phys. Rev.

E 66 (2002) 025401.

[18] D. Wu, W. Yu, Y. T. Zhao, D. H. H. Hoffmann, S.
Fritzsche, and X. T. He, Phys. Rev. E 100, 013208 (2019).
[19] Y. Sentoku, A. J. Kemp, Journal of Computational

Physics 227, 6846 (2008).

[20] T. Takizuka and H. Abe, J. Comput. Phys. 25, 205

(1977).

[21] D. Wu, X. T. He, W. Yu, and S. Fritzsche, Phys. Rev. E

95, 023207 (2017).

[22] A. E. Turrell, M. Sherlock, S. J. Rose, Journal of Com-

putational Physics 249, 13 (2013).

[23] G. E. P. Box, M. E. Muller, A note on the generation
of random normal deviates, The Annals of Mathematical
Statistics 29, 610 (1958).

[24] W. Hoermann, J. Leydold, Continuous random variate
generation by fast numerical inversion, ACM Transac-
tions on Modelling and Computer Simulation 13, 347
(2003).

[25] W. H. Press, S. A. Teukolsky, W. T. Vetterling, B. P.
Flannery, Numerical Recipes in C++, Cambridge Uni-
versity Press, 2007.

[26] C. E. Starrett, Potential of mean force for electrical con-
ductivity of dense plasmas, High Energy Density Physics
25, 8 (2017).

[27] Y. T. Lee and R. M. More, Phys. Fluids 27, 1273 (1984).
[28] H. Hrysk, P. M. Campbell, and P. Hammerling, Plasma

[9] T. Sjostrom, J. Daligault, Phys. Rev. E 92 (2015) 063304.
[10] B. Holst, M. French, R. Redmer, Phys. Rev. B 83 (2011)

Physics 17, 473 (1975).

[29] G. Zwicknagel, C. Toepffer. and P. G. Reinhard, Phys.

235120.

Rep. 309 117 (1999).

[11] M. French, T. R. Mattsson, Phys. Rev. B 90 (16) (2014)

[30] M. V. Ammosov, N. B. Delone, and V. P. Krainov, Sov.

165113.

[12] S. X. Hu, L. A. Collins, T. R. Boehly, J. D. Kress, V. N.
Goncharov, S. Skupsky, Phys. Rev. E 89 (2014) 043105.
[13] M. P. Desjarlais, C. R. Scullard, L. X. Benedict, H. D.
Whitley, R. Redmer, Phys. Rev. E 95 (2017) 033203
[14] Mark R. Krumholz, Richard I. Klein, and Christopher F.
McKee, The Astrophysical Journal 754, 71 (2012).
[15] Nick Higginbottom, Christian Knigge, Knox S Long,
James H Matthews, Stuart A Sim, Henrietta A Hewitt,
Monthly Notices of the Royal Astronomical Society, 479,
3651 (2018).

[16] C. K. Birdsall, A. B. Langdon, Plasma Physics via Com-

puter Simulation, Taylor and Francis, New York, 2005.

[17] D. Wu, W. Yu, S. Fritzsche, and X. T. He, Phys. Rev. E

100, 013207 (2019).

Phys. JETP 64, 1191 (1986).

[31] D. Wu, B. Qiao, X. T. He, C. McGuffey and F. N. Beg,

Phys. Plasmas 21, 123118 (2014).

[32] D. Wu, X. T. He, W. Yu, and S. Fritzsche, Phys. Rev. E

95, 023208 (2017).

[33] Refer to http://physics.nist.gov/PhysRefData/ASD/ for

ionization energy data.

[34] G. Ecker and W. Kroll, The Phys. Fluids 6, 62 (1963).
[35] John C. Stewart and Kedar D. Pyatt, Astr. Phys. J. 144,

1203 (1966).

[36] J. Chihara, J. Phys. 3, 8715 (1991).
[37] B. B. L. Witte, P. Sperling, M. French, V. Recoules, S. H.
Glenzer, and R. Redmer, Physics of Plasmas, 25, 056901,
(2018).

[38] B. Xu, S. X. Hu„ Physical Review E 84, 016408 (2011).

